L.Control.Base64Legend=L.Control.extend({_map:null,includes:L.Mixin.Events,options:{position:"bottomright",legends:[],collapseSimple:!1},onAdd:function(e){this._map=e;var t=L.DomUtil.create("div","leaflet-control leaflet-bar leaflet-legend");return this._container=t,L.DomEvent.disableClickPropagation(t),L.Browser.touch||L.DomEvent.disableScrollPropagation(t),this.render(),this._container},render:function(){L.DomUtil.empty(this._container);var e=this.options.legends;e&&e.forEach(function(e){if(e.elements){var t="legend-block";"stretched"===e.type&&(t+=" legend-stretched");var n=L.DomUtil.create("div",t,this._container);if(this.options.collapseSimple&&1==e.elements.length&&!e.elements[0].label)return void this._addElement(e.elements[0].imageData,e.name,n);if(e.name){var l=L.DomUtil.create("h4",null,n);L.DomUtil.create("div","caret",l),L.DomUtil.create("span",null,l).innerHTML=e.name,L.DomEvent.on(l,"click",function(){L.DomUtil.hasClass(l,"closed")?L.DomUtil.removeClass(l,"closed"):L.DomUtil.addClass(l,"closed")},this)}var i=L.DomUtil.create("div","legend-elements",n);e.elements.forEach(function(e){this._addElement(e.imageData,e.label,i)},this)}},this)},_addElement:function(e,t,n){var l=L.DomUtil.create("div","legend-row",n);L.DomUtil.create("img",null,l).src=e,t&&(L.DomUtil.create("label",null,l).innerHTML=t)}}),L.control.base64legend=function(e){return new L.Control.Base64Legend(e)};